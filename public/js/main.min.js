/*! I am Ugly! */

!function(a){"use strict";a.ready=function(){var b=a(".notifications");a.ajax({url:"../data/notification.txt"}).done(function(a){b.html("<p>"+a+"</p>")}).fail(function(a){b.html("<p>"+a+"</p>")});var c,d,e=[],f=function(b){for(var c=0;c<b.length;c++)if("object"==typeof b[c]){var d=a("#"+b[c].formID),e=d.parent().find("select"),f=e.find('option[selected="selected"]'),g=d.parent().find("iframe");null!==f&&f.removeAttr("selected"),a("<option>"+b[c].siteName+"</option>").attr({selected:"select",value:b[c].url}).appendTo(e),"object"!=typeof b[c+1]&&g.attr("src",b[c].url)}},g=function(b){var e=b.currentTarget;if(c=a(".active-tab"),c.removeClass("active-tab"),a(e).addClass("active-tab"),Modernizr.localstorage)if(d=localStorage.getItem("savedReports"),null!==d){var f=JSON.parse(d),g=f[f.length-1],h=f.length-1;"string"==typeof g&&f.splice(h,1,e.id),localStorage.savedReports=JSON.stringify(f)}else{var i=[e.id];localStorage.savedReports=JSON.stringify(i)}},h=function(b){var c=b.target,d=a(".active-item"),e=a(c).parent();null!==d&&d.removeClass("active-item"),a(c).addClass("active-item"),e.parent().hasClass("active-menu")||e.parent().addClass("active-menu")},i=function(b){var c=b.target,d=a(c).parent(),e=a(".menu-items");e.each(function(){a(this).removeClass("active-menu")}),"focus"===b.type&&d.parent().addClass("active-menu")},j=function(b){var c;a(b.currentTarget).hasClass("app-button")?(c=a(b.currentTarget).parent().find(".reports"),c.toggleClass("active-window")):(c=a(b.currentTarget).parent(),c.toggleClass("active-window"),a(b.currentTarget).hasClass("submit_btn")&&k(b))},k=function(b){var c,d=a(b.currentTarget).parent(),e=d.parent(),f=e.find("iframe");c=e.find(":selected"),f.attr("src",c[0].value)},l=function(a){a.preventDefault(),"click"===a.type?j(a):"keypress"===a.type&&13===a.keyCode&&j(a)},m=function(b){var c,d=a(b.currentTarget).parent().find("iframe"),e=d.attr("src");c=window.open(e,"_blank"),c.focus()},n=function(a){"click"===a.type?m(a):"keypress"===a.type&&13===a.keyCode&&m(a)},o=function(b){var c,d=b.target,f=a(d).children().val(),g=a(".notifications"),h=a(".js-site-name"),i=[],j=new RegExp("("+f+"(([a-z]|\\d){1,2})?)","i");console.log("SearchedInput: "+f),b.preventDefault(),h.each(function(b){""!==a(this).val()&&(console.log("This val: "+a(this).val()),i.push(a(this).val()),console.log("index: "+b),console.log("sitesNames: "+i[0]))}),0===i.length&&g.html('<p>The searched report "'+f+'" is not found.</p>');for(var k=0;k<i.length;k++)if(c=i[k].match(j),console.log("match: "+c),c[0].toLowerCase()===i[k].toLowerCase()){g.html('<p>Report "'+f+'" is found.</p>');var l,m,n=a("#"+e[k].formID).parent(),o=n.parent(),p=a(".active-tab"),q=n.find("iframe");p.removeClass("active-tab"),o.addClass("active-tab"),l=n.find(":selected"),l.removeAttr("selected"),m=n.find('option[value="'+e[k].url+'"]'),m.attr("selected","selected"),q.attr("src",m.val())}else g.html('<p>The searched report "'+f+'" is not found.</p>')},p=function(b,c){var f,g,h,i,j,k=a(b).find(".report-row"),l=k.eq(0).find(".js-site-name"),m=k.eq(0).find(".js-site-url"),n=a(b).find(".system-message"),o=a(".wrong"),p=localStorage.savedReports;for(e=[],o.each(function(){a(this).removeClass("wrong")}),n.html(""),""===l.val()&&""===m.val()&&!p||p.length<=8?(n.html("Please, write site name and URL before saving."),l.focus()):""===l.val()&&""===m.val()&&p.length>8&&(a(b).toggleClass("active-window"),a(b).prev().empty(),localStorage.removeItem(d),a(b).next().find("iframe").removeAttr("src")),f=0;f<k.length;f++)g=k.eq(f),h=g.find(".js-site-name"),i=g.find(".js-site-url"),(""!==h.val()||""!==i.val())&&("http"!==i.val().substring(0,4)&&i.val("http://"+i.val()),""!==h.val()&&""===i.val()?(n.html("Please, enter the site URL!"),i.addClass("wrong"),i.focus()):""===h.value&&""!==i.value?(n.html("Please, write the title for entered URL!"),h.addClass("wrong"),h.focus()):""!==h.val()&&""!==i.val()&&(j=q(i.val()),j?s(h.val(),i.val(),c,b,g[0]):(n.html("Please, enter valid URL!"),i.addClass("wrong"),i.focus())))},q=function(a){var b=/http(s)?:\/\/w{0,3}.+\.\w{2,4}(.+)?/g;return b.test(a)},r=function(a){var b=a.target.parentNode;a.preventDefault(),p(b,a)},s=function(b,c,d,g,h){var i=a(g).parent().find("select"),j=i.find(":selected"),k=a(g).parent(),m=k.parent().attr("id"),n=h.id,o={};i.empty(),o={siteName:b,url:c,fieldID:n,formID:g.id},f(e),e.push(o),e.push(m),Modernizr.localstorage&&(localStorage.savedReports=JSON.stringify(e)),j&&j.removeAttr("selected"),a("<option/>",{value:c,selected:"selected",text:b}).appendTo(i),l(d)},t=function(b){var c=b.target,d=a(c).parent().parent();27===b.keyCode&&d.removeClass("active-window")},u=function(){var b;d=localStorage.getItem("savedReports"),console.log("Init"),console.log(d),console.log("Modernizr.input.placeholder: "+Modernizr.input.placeholder);var e=a(".js-site-name"),j=a(".js-site-url"),m=a("#search"),p=a("#search > input");if(m.on("submit",o),!Modernizr.input.placeholder){var q=function(a){var b=a.target;("Site name"===b.value||"Site URL"===b.value||"Search"===b.value)&&(b.value="")};p.val("Search"),p.on("focus",q),e.each(function(a){e.eq(a).val("Site name"),j.eq(a).val("Site URL"),e.eq(a).on("focus",q),j.eq(a).on("focus",q)})}if(Modernizr.localstorage&&(d=localStorage.getItem("savedReports"))){var s,u,v,w,x=JSON.parse(d);for(b=0;b<x.length;b++)x[b].fieldID&&(s=x[b].fieldID,u=a("#"+s),v=u.find(".js-site-name"),w=u.find(".js-site-url"),w.val(x[b].url),v.val(x[b].siteName));if("string"==typeof x[x.length-1]){var y;c=a(".active-tab"),c.removeClass("active-tab"),y=a("#"+x[x.length-1]),y.addClass("active-tab")}var z=[];a(x).each(function(a){"object"==typeof x[a]&&z.push(x[a])}),f(z)}var A=a(".menu-items a");A.each(function(a){A.eq(a).on("focus",h)});var B=a(".menu-items li:first-child a");B.each(function(a){B.eq(a).on("focus",i)});var C=a(".last-menu-item");C.on("blur",i);var D=a(".tab");D.each(function(a){D.eq(a).on("click focus",g)});var E=a(".new-tab-btn");E.each(function(a){E.eq(a).on("click keypress",n)});var F=a(".reports-btn");F.each(function(a){F.eq(a).on("click keypress",l)});var G=a(".cancel-btn");G.each(function(a){G.eq(a).on("click keypress",l)});var H=a(".submit_btn");H.each(function(a){H.eq(a).on("click keypress",r)});var I=a("select");I.each(function(a){I.eq(a).on("change",k)});var J=a(".reports input");J.each(function(a){J.eq(a).on("keyup",t)})};u()}}(jQuery);
//# sourceMappingURL=main.min.js.map